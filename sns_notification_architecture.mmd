graph TD
    %% ========================================================================
    %% Makenaide SNS ì•Œë¦¼ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
    %% EventBridge + Lambda + EC2 + SNS í†µí•© ì„¤ê³„
    %% ========================================================================

    %% EventBridge ìŠ¤ì¼€ì¤„ëŸ¬
    EB["â° EventBridge Scheduler<br/>í•˜ë£¨ 7íšŒ ì‹¤í–‰<br/>(02:00, 09:00, 15:00, 18:00, 21:00, 23:00 UTC)"]

    %% Lambda í•¨ìˆ˜
    EB --> LF["âš¡ Lambda Function<br/>makenaide-ec2-auto-starter<br/>â€¢ EC2 ì‹œì‘ë§Œ ë‹´ë‹¹<br/>â€¢ ì‹œì‘ ì„±ê³µ/ì‹¤íŒ¨ ì•Œë¦¼"]

    %% EC2 ì¸ìŠ¤í„´ìŠ¤
    LF --> EC2["ğŸ–¥ï¸ EC2 Instance<br/>makenaide.py ì‹¤í–‰<br/>â€¢ SNS í†µí•© ëª¨ë“ˆ í¬í•¨<br/>â€¢ ë‹¨ê³„ë³„ ì•Œë¦¼ ì „ì†¡<br/>â€¢ ìë™ shutdown"]

    %% SNS Topics
    subgraph "ğŸ“¢ SNS Topics"
        SNS_T["ğŸ“ˆ makenaide-trading-alerts<br/>â€¢ ê±°ë˜ ì‹¤í–‰ ê²°ê³¼<br/>â€¢ í¬íŠ¸í´ë¦¬ì˜¤ ìƒíƒœ<br/>â€¢ ìˆ˜ìµ/ì†ì‹¤ ì•Œë¦¼"]

        SNS_S["ğŸ”§ makenaide-system-alerts<br/>â€¢ ì‹œìŠ¤í…œ ì˜¤ë¥˜<br/>â€¢ íŒŒì´í”„ë¼ì¸ ìƒíƒœ<br/>â€¢ EC2 ì‹œì‘/ì¢…ë£Œ"]
    end

    %% ì•Œë¦¼ êµ¬ë…ì
    subgraph "ğŸ“§ Notification Subscribers"
        EMAIL1["ğŸ“¨ Trading Email<br/>â€¢ ê±°ë˜ ì•Œë¦¼<br/>â€¢ í¬íŠ¸í´ë¦¬ì˜¤ ì—…ë°ì´íŠ¸<br/>â€¢ í•„í„°: TRADING, PORTFOLIO"]

        EMAIL2["ğŸš¨ System Email<br/>â€¢ ì‹œìŠ¤í…œ ì˜¤ë¥˜<br/>â€¢ CRITICAL/WARNINGë§Œ<br/>â€¢ í•„í„°: CRITICAL, WARNING"]

        SLACK["ğŸ’¬ Slack (ì„ íƒì )<br/>â€¢ ì‹¤ì‹œê°„ ì•Œë¦¼<br/>â€¢ íŒ€ ê³µìœ "]

        SMS["ğŸ“± SMS (ì„ íƒì )<br/>â€¢ CRITICALë§Œ<br/>â€¢ ê¸´ê¸‰ ì•Œë¦¼"]
    end

    %% ì•Œë¦¼ ê²½ë¡œ ì—°ê²°
    LF --> SNS_S
    EC2 --> SNS_T
    EC2 --> SNS_S

    SNS_T --> EMAIL1
    SNS_S --> EMAIL2
    SNS_T --> SLACK
    SNS_S --> SMS

    %% ========================================================================
    %% íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ë³„ ì•Œë¦¼ í”Œë¡œìš°
    %% ========================================================================

    subgraph "ğŸ”„ Pipeline Notification Flow"
        P0["ğŸ“¡ Phase 0: Scanner<br/>â€¢ ì¢…ëª© ìŠ¤ìº” ì™„ë£Œ ì•Œë¦¼<br/>â€¢ ìŠ¤ìº”ëœ ì¢…ëª© ìˆ˜"]

        P1["ğŸ“Š Phase 1: Data Collection<br/>â€¢ ë°ì´í„° ê°­ ìˆ˜ì§‘ ì™„ë£Œ<br/>â€¢ ìˆ˜ì§‘ëœ ë°ì´í„° ìš”ì•½"]

        P2["ğŸ¯ Phase 2: Technical Filter<br/>â€¢ Stage 2 í›„ë³´ ë°œê²¬<br/>â€¢ ìƒìœ„ í›„ë³´ ëª©ë¡"]

        P3["ğŸ¤– Phase 3: GPT Analysis<br/>â€¢ GPT ìŠ¹ì¸ ì¢…ëª©<br/>â€¢ ë¶„ì„ ë¹„ìš©"]

        MS["ğŸŒ¡ï¸ Market Sentiment<br/>â€¢ BEAR ì‹œì¥ ê²½ê³ <br/>â€¢ ê±°ë˜ ì¤‘ë‹¨ ì•Œë¦¼"]

        TE["ğŸ’¸ Trading Execution<br/>â€¢ ë§¤ìˆ˜/ë§¤ë„ ì„±ê³µ/ì‹¤íŒ¨<br/>â€¢ ê±°ë˜ ê¸ˆì•¡ ë° ê°€ê²©"]

        PM["ğŸ“Š Portfolio Management<br/>â€¢ í¬íŠ¸í´ë¦¬ì˜¤ í˜„í™©<br/>â€¢ ì†ìµ ìƒíƒœ"]

        PC["ğŸ Pipeline Complete<br/>â€¢ ì „ì²´ ì‹¤í–‰ ê²°ê³¼<br/>â€¢ ì„±ê³¼ ìš”ì•½"]
    end

    %% íŒŒì´í”„ë¼ì¸ ì•Œë¦¼ ì—°ê²°
    EC2 --> P0
    P0 --> P1
    P1 --> P2
    P2 --> P3
    P3 --> MS
    MS --> TE
    TE --> PM
    PM --> PC

    %% ê° ë‹¨ê³„ì—ì„œ SNSë¡œ ì•Œë¦¼
    P0 --> SNS_S
    P1 --> SNS_S
    P2 --> SNS_T
    P3 --> SNS_T
    MS --> SNS_S
    TE --> SNS_T
    PM --> SNS_T
    PC --> SNS_S

    %% ========================================================================
    %% ì•Œë¦¼ ë ˆë²¨ ë° í•„í„°ë§ ì‹œìŠ¤í…œ
    %% ========================================================================

    subgraph "ğŸš¦ Notification Levels & Filtering"
        CRIT["ğŸš¨ CRITICAL<br/>â€¢ ì‹œìŠ¤í…œ ì˜¤ë¥˜<br/>â€¢ ê±°ë˜ ì‹¤íŒ¨<br/>â€¢ ì¦‰ì‹œ ì•Œë¦¼"]

        WARN["âš ï¸ WARNING<br/>â€¢ BEAR ì‹œì¥<br/>â€¢ ì¡°ê±´ ë¯¸ì¶©ì¡±<br/>â€¢ ì£¼ì˜ í•„ìš”"]

        SUCC["âœ… SUCCESS<br/>â€¢ ê±°ë˜ ì„±ê³µ<br/>â€¢ ëª©í‘œ ë‹¬ì„±<br/>â€¢ ê¸ì •ì  ê²°ê³¼"]

        INFO["â„¹ï¸ INFO<br/>â€¢ íŒŒì´í”„ë¼ì¸ ì§„í–‰<br/>â€¢ ìƒíƒœ ì—…ë°ì´íŠ¸<br/>â€¢ ì¼ë°˜ ì •ë³´"]
    end

    %% í•„í„°ë§ ì •ì±…
    subgraph "ğŸ” Filtering Policies"
        FP1["ğŸ“ˆ Trading Filter<br/>â€¢ Category: TRADING, PORTFOLIO<br/>â€¢ Level: ALL<br/>â€¢ Time: 24/7"]

        FP2["ğŸ”§ System Filter<br/>â€¢ Category: SYSTEM, PIPELINE<br/>â€¢ Level: CRITICAL, WARNING<br/>â€¢ Quiet Hours: 01:00-07:00"]

        FP3["ğŸ’° Cost Control<br/>â€¢ Daily Limit: 50 messages<br/>â€¢ CRITICAL: No limit<br/>â€¢ Auto-reset daily"]
    end

    %% ========================================================================
    %% ë¹„ìš© ìµœì í™” ë° ëª¨ë‹ˆí„°ë§
    %% ========================================================================

    subgraph "ğŸ’° Cost Optimization"
        CO1["ğŸ“Š Message Tracking<br/>â€¢ ì¼ì¼ ë©”ì‹œì§€ ìˆ˜ ì¶”ì <br/>â€¢ ë¹„ìš© ì„ê³„ê°’ ëª¨ë‹ˆí„°ë§<br/>â€¢ ìë™ ì œí•œ"]

        CO2["â° Quiet Hours<br/>â€¢ 01:00-07:00 KST<br/>â€¢ INFO ë ˆë²¨ ì œí•œ<br/>â€¢ CRITICALì€ ì˜ˆì™¸"]

        CO3["ğŸ¯ Smart Filtering<br/>â€¢ ì¤‘ë³µ ì•Œë¦¼ ë°©ì§€<br/>â€¢ ì¤‘ìš”ë„ ê¸°ë°˜ ìš°ì„ ìˆœìœ„<br/>â€¢ ë°°ì¹˜ ì²˜ë¦¬"]
    end

    %% ========================================================================
    %% ì„¤ì • ë° í™˜ê²½ ë³€ìˆ˜
    %% ========================================================================

    subgraph "âš™ï¸ Configuration"
        ENV["ğŸ”§ Environment Variables<br/>â€¢ SNS_NOTIFICATIONS_ENABLED<br/>â€¢ SNS_CRITICAL_ONLY<br/>â€¢ SNS_MAX_DAILY_MESSAGES<br/>â€¢ SNS_QUIET_START/END<br/>â€¢ SNS_TOPIC_ARNs"]

        CFG["ğŸ“‹ Dynamic Configuration<br/>â€¢ Runtime ì„¤ì • ë³€ê²½<br/>â€¢ ì•Œë¦¼ ë ˆë²¨ ì¡°ì •<br/>â€¢ í•„í„° ì •ì±… ì—…ë°ì´íŠ¸"]
    end

    %% ========================================================================
    %% ìŠ¤íƒ€ì¼ë§
    %% ========================================================================

    %% EventBridge & Lambda
    style EB fill:#ff9800,stroke:#333,stroke-width:3px
    style LF fill:#2196f3,stroke:#333,stroke-width:3px

    %% EC2 & Pipeline
    style EC2 fill:#4caf50,stroke:#333,stroke-width:4px
    style P0 fill:#e1f5fe,stroke:#333,stroke-width:2px
    style P1 fill:#e1f5fe,stroke:#333,stroke-width:2px
    style P2 fill:#fff3e0,stroke:#333,stroke-width:2px
    style P3 fill:#f3e5f5,stroke:#333,stroke-width:2px
    style MS fill:#ffebee,stroke:#333,stroke-width:3px
    style TE fill:#e8f5e8,stroke:#333,stroke-width:3px
    style PM fill:#e3f2fd,stroke:#333,stroke-width:2px
    style PC fill:#f1f8e9,stroke:#333,stroke-width:3px

    %% SNS Topics
    style SNS_T fill:#ff4081,stroke:#333,stroke-width:3px
    style SNS_S fill:#ff5722,stroke:#333,stroke-width:3px

    %% Subscribers
    style EMAIL1 fill:#8bc34a,stroke:#333,stroke-width:2px
    style EMAIL2 fill:#ff7043,stroke:#333,stroke-width:2px
    style SLACK fill:#9c27b0,stroke:#333,stroke-width:2px
    style SMS fill:#607d8b,stroke:#333,stroke-width:2px

    %% Notification Levels
    style CRIT fill:#f44336,stroke:#333,stroke-width:3px
    style WARN fill:#ff9800,stroke:#333,stroke-width:2px
    style SUCC fill:#4caf50,stroke:#333,stroke-width:2px
    style INFO fill:#2196f3,stroke:#333,stroke-width:2px

    %% Configuration
    style ENV fill:#795548,stroke:#333,stroke-width:2px
    style CFG fill:#607d8b,stroke:#333,stroke-width:2px